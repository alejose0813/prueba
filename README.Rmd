---
output: github_document
---

---
title: "Taller_Conejos"
output: html_document
date: "2024-08-03"
---

# **Jose Alejandro Castellanos Ortega**

```{r, warning=FALSE, include=FALSE}
library(forecast)
library(TSA)
library("ggplot2")
library(MLmetrics)
library("dplyr")
data(hare)
ts.raiz=(hare^.5)
head(hare)
```

Para los puntos siguientes tenga en cuenta el siguiente modelo:
```{r}
m2.hare=Arima(sqrt(hare),order=c(3,0,0),fixed=c(NA,0,NA,NA))
m2.hare
```
# Taller
# Medidas de error del pronostico.

# 1. Con la función fitted(modelo) puedes generar los pronósticos intramuestra

```{r}
predicted <- fitted(m2.hare) # Guarda en este objeto los valores pronósticados
predicted2 <- predicted ^ 2 ### Aplica una trasnformación para volver a los pronósticos en la escala original
predicted2 <- round(predicted2, 0) # redondea estos pronosticos con cero decimales
predicted2
```
# 2. Crea un data frame con los valores pronósticados, los valores pronosticados en su escala original, y los valores originales de los datos

```{r}
cnj <- data.frame(predicted,predicted2,hare)
cnj <-  cnj %>% 
  mutate(Year = seq(1905,1935, by= 1)) %>% 
  relocate(Year, .before = predicted)
head(cnj, 2)
```
# 3. con la instrucción ts.plot crea un grafico donde se observe los valores originales y los valores predichos en su escala original.

```{r}
ts.plot(predicted2,hare, col=1:2, type="o", ylim=c(1,120), xlim=c(1905,1935))
```

```{r, warning=FALSE}
# library("ggplot2")
cnj %>% 
  ggplot(aes(x= Year)) +
  geom_line(aes(y= hare, color= "hare")) +
  geom_line(aes(y= predicted2, color= "predicted2")) +
  geom_point(aes(y= predicted2, color= "predicted2")) +
  scale_x_continuous(breaks = seq(1905, 1935, by= 5)) +
  labs(x = "Time", y = "", color = "Variables") +
  theme(legend.position = 'top')
```

# 4. Calcula:
```{r}
error= cnj$predicted # la raiz de los datos - la raiz pronosticada
error2= cnj$hare - cnj$predicted2# Los errores de los datos Vs los pronósticos en su escala original
data.frame(ts.raiz,predicted,hare,predicted2,error2,error,residuals(m2.hare)) # observa estedata frame
```

https://www.statology.org/mape-r/
MAPE(y_pred, y_true) where:  y_pred: predicted values, y_true: actual values

# 5. Usa la libreria MLmetrics  , con las funciones MAPE(x,y), RMSE(x,y), MAE(x,y) para calcular las metricas de las predicciones en la escala original

```{r}
# library(MLmetrics)
MAPE(cnj$predicted2, cnj$hare)
RMSE(cnj$predicted2, cnj$hare)
MAE(cnj$predicted2, cnj$hare)
```


# 6. Calcula la formula del MAPE y RMSE de las predicciones en la escala original para comprobar los valores anteriores.
mean(abs((hare-predicted2)/hare)) * 100 # MAPE
sqrt(mean((hare-predicted2)^2)) # RMSE

```{r}
mean(abs((cnj$hare-cnj$predicted2)/cnj$hare)) * 100 # MAPE
sqrt(mean((cnj$hare-cnj$predicted2)^2)) # RMSE
```


